package org.firstinspires.ftc.teamcode.Auto;

import androidx.annotation.NonNull;

import com.acmerobotics.dashboard.FtcDashboard;
import com.acmerobotics.dashboard.telemetry.MultipleTelemetry;
import com.acmerobotics.dashboard.telemetry.TelemetryPacket;
import com.acmerobotics.roadrunner.Action;
import com.acmerobotics.roadrunner.AngularVelConstraint;
import com.acmerobotics.roadrunner.MinVelConstraint;
import com.acmerobotics.roadrunner.Pose2d;
import com.acmerobotics.roadrunner.SequentialAction;
import com.acmerobotics.roadrunner.TrajectoryActionBuilder;
import com.acmerobotics.roadrunner.TranslationalVelConstraint;
import com.acmerobotics.roadrunner.ftc.Actions;
import com.qualcomm.robotcore.eventloop.opmode.Autonomous;
import com.qualcomm.robotcore.eventloop.opmode.LinearOpMode;
import com.qualcomm.robotcore.hardware.DcMotor;
import com.qualcomm.robotcore.hardware.DcMotorEx;

import org.firstinspires.ftc.teamcode.HardwareClasses.testHardware;
import org.firstinspires.ftc.teamcode.MecanumDrive;
import com.acmerobotics.roadrunner.Vector2d;
import com.qualcomm.robotcore.hardware.DcMotorSimple;
import com.qualcomm.robotcore.hardware.HardwareMap;
import com.qualcomm.robotcore.hardware.Servo;
import com.qualcomm.robotcore.util.ElapsedTime;

import java.util.Arrays;

@Autonomous(name="NewBucketAuto", group="RedSide")
public class NewAutoRedBucket extends LinearOpMode {

    private final testHardware robot = new testHardware();
    private ElapsedTime runtime = new ElapsedTime();

    public void runOpMode() throws InterruptedException {
        Pose2d initialPose = new Pose2d(-34, -62, Math.toRadians(90));
        MecanumDrive drive = new MecanumDrive(hardwareMap, initialPose);
        robot.init(hardwareMap);
        Vector2d basketPos = new Vector2d(-60, -60);
        waitForStart();
        robot.clawRotate.setPosition(0);
        robot.claw.setPosition(1);
        double slideInitPos = robot.rightSlide.getCurrentPosition();
                Vector2d releasePos = new Vector2d(-65,-58);
        Vector2d firstPiecePos = new Vector2d(-57,-43);
        Vector2d secondPiecePos = new Vector2d(-59,-44);

        FtcDashboard dashboard = FtcDashboard.getInstance();
        telemetry = new MultipleTelemetry(telemetry, dashboard.getTelemetry());

        telemetry.addData("Right slide current position: ", robot.rightSlide.getCurrentPosition());

        if (!isStopRequested() && opModeIsActive()) {
            TrajectoryActionBuilder action2 = drive.actionBuilder(initialPose)
                    .lineToYConstantHeading(-50);
            TrajectoryActionBuilder action3 = action2.endTrajectory().fresh()
                    .strafeToLinearHeading(releasePos, Math.toRadians(45));
            TrajectoryActionBuilder action4 = action3.endTrajectory().fresh()
                    .waitSeconds(1.25)
                    .strafeToLinearHeading(firstPiecePos, Math.toRadians(64));
            TrajectoryActionBuilder action5 = action4.endTrajectory().fresh()
                    .strafeToLinearHeading(releasePos, Math.toRadians(45), drive.slowVelConstraint);
            TrajectoryActionBuilder action6 = action5.endTrajectory().fresh()
                    .strafeToLinearHeading(secondPiecePos, Math.toRadians(90))
                    .waitSeconds(0.5);
            TrajectoryActionBuilder action7 = action6.endTrajectory().fresh()
                    .strafeToLinearHeading(releasePos, Math.toRadians(45), drive.slowVelConstraint);
            TrajectoryActionBuilder action8 = action7.endTrajectory().fresh()
                    .strafeToLinearHeading(new Vector2d(-60.5, -43),Math.toRadians(110));
            TrajectoryActionBuilder action9 = action8.endTrajectory().fresh()
                    .strafeToLinearHeading(releasePos, Math.toRadians(45), drive.mediumVelConstraint                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               );
            TrajectoryActionBuilder action = drive.actionBuilder(initialPose)
//                    .strafeTo(basketPos)3
//                .waitSeconds(0.5)
//                .turn(Math.toRadians(-45))
//                .waitSeconds(0.5)
                    .lineToYConstantHeading(-50)
                    .strafeToLinearHeading(releasePos, Math.toRadians(45))
                    .waitSeconds(0.25)
                    //release preload
                    .strafeTo(basketPos)
                    .waitSeconds(0.25)
                    .strafeToSplineHeading(firstPiecePos, Math.toRadians(90)) //grab first sample
                    .waitSeconds(0.25)
                    .strafeToSplineHeading(basketPos, Math.toRadians(45))
                    .waitSeconds(0.25)
                    .strafeToSplineHeading(releasePos, Math.toRadians(45))
                    .waitSeconds(0.25)
                    .strafeToSplineHeading(basketPos, Math.toRadians(45))
                    .waitSeconds(0.25)
                    .strafeToSplineHeading(secondPiecePos, Math.toRadians(90))
                    .waitSeconds(0.25)
                    //drop sample
                    .strafeToSplineHeading(basketPos, Math.toRadians(45))
                    .waitSeconds(0.25)
                    .strafeToSplineHeading(releasePos, Math.toRadians(45))
                    .waitSeconds(0.25)
                    .strafeToSplineHeading(basketPos, Math.toRadians(45))
                    .waitSeconds(0.25)
                    //drop sample
//                THIRD SAMPLE
                    .splineToLinearHeading(new Pose2d(-55, -36, Math.toRadians(90)), Math.PI / 2)
                    .waitSeconds(0.25)
                    .splineToLinearHeading(new Pose2d(-34, -9, Math.toRadians(90)), Math.PI / 2)
                    .waitSeconds(0.25)
                    .splineToLinearHeading(new Pose2d(-25, -12, Math.toRadians(90)), Math.PI / 2)
                    .waitSeconds(0.25);
//            while (robot.rightSlide.getCurrentPosition() > (slideInitPos - 11594)) {
//                robot.rightSlide.setPower(-1);
//                robot.leftSlide.setPower(-1);
//            }
//            robot.rightSlide.setPower(0);
//            robot.leftSlide.setPower(0);
            Actions.runBlocking(action2.build());
            robot.rightSlide.setPower(-1);
            robot.leftSlide.setPower(-1);
            Actions.runBlocking(action3.build());
            robot.rightSlide.setPower(-0.2);
            robot.leftSlide.setPower(-0.2);
            robot.release.setPosition(1);
            Actions.runBlocking(action4.build());
            robot.release.setPosition(0);
            robot.intakeArm.setPower(0.5);
            sleep(450);
            robot.rightSlide.setPower(1);
            robot.leftSlide.setPower(1);
            robot.intakeArm.setPower(0);
            robot.clawRotate.setPosition(1);
            sleep(750);
            robot.claw.setPosition(0);
            sleep(450);
            robot.intakeArm.setPower(-0.675);
            sleep(450);
            robot.clawRotate.setPosition(0);
            sleep(250);
            robot.claw.setPosition(1);
            sleep(600);
            robot.rightSlide.setPower(-1);
            robot.leftSlide.setPower(-1);
            Actions.runBlocking(action5.build());
            robot.rightSlide.setPower(-0.2);
            robot.leftSlide.setPower(-0.2);
            robot.release.setPosition(1);
            sleep(350);
            Actions.runBlocking(action6.build());
            robot.release.setPosition(0);
            robot.intakeArm.setPower(0.5);
            sleep(675);
            robot.rightSlide.setPower(1);
            robot.leftSlide.setPower(1);
            robot.intakeArm.setPower(0);
            robot.clawRotate.setPosition(1);
            sleep(750);
            robot.claw.setPosition(0);
            sleep(450);
            robot.intakeArm.setPower(-0.675);
            sleep(450);
            robot.clawRotate.setPosition(0);
            sleep(250);
            robot.claw.setPosition(1);
            sleep(600);
            robot.rightSlide.setPower(-1);
            robot.leftSlide.setPower(-1);
            Actions.runBlocking(action7.build());
            robot.rightSlide.setPower(-0.2);
            robot.leftSlide.setPower(-0.2);
            robot.release.setPosition(1);
            sleep(350);
            Actions.runBlocking(action8.build());
            robot.release.setPosition(0);
            robot.intakeArm.setPower(0.5);
            sleep(675);
            robot.rightSlide.setPower(1);
            robot.leftSlide.setPower(1);
            robot.intakeArm.setPower(0);
            robot.clawRotate.setPosition(1);
            sleep(750);
            robot.claw.setPosition(0);
            sleep(450);
            robot.intakeArm.setPower(-0.675);
            sleep(450);
            robot.clawRotate.setPosition(0);
            sleep(250);
            robot.claw.setPosition(1);
            sleep(600);
            robot.rightSlide.setPower(-1);
            robot.leftSlide.setPower(-1);
            Actions.runBlocking(action9.build());
            robot.release.setPosition(1);
            robot.rightSlide.setPower(-0.2);
            robot.leftSlide.setPower(-0.2);
            sleep(150);
            robot.leftFrontDrive.setPower(0.9);
            robot.rightFrontDrive.setPower(0.9);
            robot.rightBackDrive.setPower(0.9);
            robot.leftBackDrive.setPower(0.9);
            sleep(500);
        }
    }
}


//MEEP MEEP
//This is the associated MeepMeep with the above code. To run it, switch over to the "MeepMeepTesting"
//branch and run "myClass".
//Vector2d basketPos = new Vector2d(-56, -56);
//        Vector2d releasePos = new Vector2d(-58,-58);
//        Vector2d firstPiecePos = new Vector2d(-48.5,-33.25);
//        Vector2d secondPiecePos = new Vector2d(-57,-33.25);
////        Vector2d thirdPiecePos = new Vector2d()
//        RoadRunnerBotEntity myBot = new DefaultBotBuilder(meepMeep)
//                // Set bot constraints: maxVel, maxAccel, maxAngVel, maxAngAccel, track width
//                .setColorScheme(new ColorSchemeRedLight())
//                .setConstraints(60, 60, Math.toRadians(180), Math.toRadians(180), 15)
//                .setDimensions(17.5, 14.5)
//                .setStartPose(new Pose2d(-34, -63, Math.toRadians(90)))
//                .build();
//        myBot.runAction(myBot.getDrive().actionBuilder(new Pose2d(-34, -63, Math.toRadians(90)))
//                .strafeTo(basketPos)
//                .waitSeconds(1)
//                .turn(Math.toRadians(-45))
//                .waitSeconds(1)
//                .strafeTo(releasePos)
//                .waitSeconds(1)
//                //release preload
//                .strafeTo(basketPos)
//                .waitSeconds(1)
//                .strafeToSplineHeading(firstPiecePos, Math.toRadians(90)) //grab first sample
//                .waitSeconds(1)
//                .strafeToSplineHeading(basketPos, Math.toRadians(45))
//                .waitSeconds(1)
//                .strafeToSplineHeading(releasePos, Math.toRadians(45))
//                .waitSeconds(1)
//                .strafeToSplineHeading(basketPos, Math.toRadians(45))
//                .waitSeconds(1)
//                .strafeToSplineHeading(secondPiecePos, Math.toRadians(90))
//                .waitSeconds(1)
//                //drop sample
//                .strafeToSplineHeading(basketPos, Math.toRadians(45))
//                .waitSeconds(1)
//                .strafeToSplineHeading(releasePos, Math.toRadians(45))
//                .waitSeconds(1)
//                .strafeToSplineHeading(basketPos, Math.toRadians(45))
//                .waitSeconds(1)
//                //drop sample
////                THIRD SAMPLE
//                .splineToLinearHeading(new Pose2d(-55, -36, Math.toRadians(90)), Math.PI/2)
//                .waitSeconds(1)
//                .splineToLinearHeading(new Pose2d(-34, -9, Math.toRadians(90)), Math.PI/2)
//                .waitSeconds(1)
//                .splineToLinearHeading(new Pose2d(-25, -12, Math.toRadians(90)), Math.PI/2)
//                .waitSeconds(1)